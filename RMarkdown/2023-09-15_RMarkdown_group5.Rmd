---
title: "Group 5 Report"
author: "Dagfinn, Mathilde, Joanna, Ingvild"
date: "2023-09-15"
output: html_document
---

Load library
```{r, echo=FALSE, message = FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(here)
library(patchwork)
library(skimr)
library(naniar)
library(GGally)
```

Read file
```{r, echo=FALSE, message=FALSE}
OurData <- read_delim(here("Data", "tidy_exam_data.txt"))
```

## Description of data

### Tidying data

## Wrangling data

## Plotting data
### Exploring correlated measurements
```{r, echo=FALSE, warning=FALSE, message=FALSE}
multiple_correlations_plot <- ggpairs(OurData[c("BMI", 
                    "Age", 
                    "Education", 
                    "GA.at.outcome", 
                    "Birthweight",
                    "IL6_baseline",
                    "IL8_baseline")])

multiple_correlations_plot
```


## Analyses

Lastly, we analyzed our data focusing on birthweight and birth outcome. First, we checked whether birth outcome was dependent of the enrollment center. There was a significant difference between the different enrollment centers (p=.0286).

```{r, echo=FALSE, warning=FALSE, message=FALSE}
OurData %>%
  aov(Birthweight~Enroll.Center, data = .) %>%
  broom::tidy()


Enroll.Center_birthweight <- ggplot(OurData,
                                aes(x = Enroll.Center, y = Birthweight, fill = Enroll.Center)) +
  geom_boxplot(aes(color = Enroll.Center)) +
  theme_minimal() +
  labs(title = "Enroll.Center vs. birthweight")
Enroll.Center_birthweight
```




Second, birth outcome was also dependent of BMI of the patient (p=.0458).

```{r, echo=FALSE, warning=FALSE, message=FALSE}
OurData %>% 
  kruskal.test(Birth.outcome~BMI, data = .) %>%
  broom::tidy()


Hist_BMI_Birth.outcome <- ggplot(OurData, aes(x=BMI)) +
  geom_histogram(aes(fill=Birth.outcome), bins=30, alpha=0.7, position="identity") + 
  facet_wrap(~ Birth.outcome, scales="free_y") +
  labs(title="Distribution of BMI by Birth Outcome", 
       x="BMI", y="Count") +
  theme_minimal()

print(Hist_BMI_Birth.outcome)
```




However, there was no difference in birthweight between different race categories (p=.546).

```{r, echo=FALSE, warning=FALSE, message=FALSE}
ANOVAresultraceBW <- OurData %>%
    aov(Birthweight~ race, data = .)
ANOVAresultraceBW %>%
  broom::tidy()


ggplot(data=OurData) +
  aes(x = Birthweight) +
  geom_boxplot(aes(color = race)) +
  facet_grid(rows = vars(race))
```




Sadly, the treatment intervention did neither affect the birthweight (p=.566)

```{r, echo=FALSE, warning=FALSE, message=FALSE}
OurData %>% 
  t.test(Birthweight~Group, data = .) %>%
  broom::tidy()


ggplot(OurData, aes(x = Group, y = Birthweight, fill = Group)) +
  geom_boxplot() +
  labs(title = "Comparison of Birthweight between Groups C and T",
       x = "Group",
       y = "Birthweight") +
  theme_minimal()
```


## Session Info
```{r}
sessionInfo()
```



